
- name: Get MySQL
  get_url: url=http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm dest=/home/centos/mysql-community-release-el7-5.noarch.rpm

- name: Install repo
  yum: name=/home/centos/mysql-community-release-el7-5.noarch.rpm state=present

- name: Install MySQL
  yum: name={{ item }} state=present
  with_items:
    - mysql-community-server
    - MySQL-python

- name: Start MySQL
  service: name=mysqld
           enabled=yes
           state=started

- name: Add user
  mysql_user: name={{ user }} password={{ password }} priv=*.*:ALL state=present host={{ item }}
  with_items:
    - "{{ ansible_hostname }}"
    - 127.0.0.1
    - localhost
    - "%"

- name: Create databse
  mysql_db: name={{ database }} state=present
